#!/usr/bin/env perl

use strict;
use warnings;

our $delimiter = ',';
our $replace = 0;

use Getopt::Long;
Getopt::Long::Configure ("bundling");
GetOptions
  '-r'   => sub { $replace = 1 },
  '-d=s' => sub { $delimiter = qr/\Q$_[1]\E/ },
or exit(1);

while (<>) {
  chomp;
  my @input = split /\Q$delimiter\E/;
  my $n = @input;
  my @output;
  for my $iter (1..$n) {
    my $i = int rand @input;
    push @output, $input[$i];
    splice @input, $i, 1 unless $replace;
  }
  print join($delimiter,@output), "\n";
}
